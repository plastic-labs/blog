<!doctype html><html lang=en><head><meta charset=utf-8><meta name=description content="TL;DR Today we’re releasing a major upgrade to Bloom (& the open-source codebase, Tutor-GPT).
We gave our tutor even more autonomy to reason about the psychology of the user, and—using GPT-4 to dynamically rewrite its own system prompts—we’re able to dramatically expand the scope of what Bloom can do and massively reduce our prompting architecture."><meta property="og:title" content="Theory-of-Mind Is All You Need"><meta property="og:description" content="TL;DR Today we’re releasing a major upgrade to Bloom (& the open-source codebase, Tutor-GPT).
We gave our tutor even more autonomy to reason about the psychology of the user, and—using GPT-4 to dynamically rewrite its own system prompts—we’re able to dramatically expand the scope of what Bloom can do and massively reduce our prompting architecture."><meta property="og:type" content="website"><meta property="og:image" content="https://plasticlabs.aiicon.png"><meta property="og:url" content="https://plasticlabs.ai/blog/Theory-of-Mind-Is-All-You-Need/"><meta property="og:width" content="200"><meta property="og:height" content="200"><meta name=twitter:card content="summary"><meta name=twitter:title content="Theory-of-Mind Is All You Need"><meta name=twitter:description content="TL;DR Today we’re releasing a major upgrade to Bloom (& the open-source codebase, Tutor-GPT).
We gave our tutor even more autonomy to reason about the psychology of the user, and—using GPT-4 to dynamically rewrite its own system prompts—we’re able to dramatically expand the scope of what Bloom can do and massively reduce our prompting architecture."><meta name=twitter:image content="https://plasticlabs.aiicon.png"><meta name=twitter:site content="plastic_labs"><title>Theory-of-Mind Is All You Need</title><meta name=viewport content="width=device-width,initial-scale=1"><link rel="shortcut icon" type=image/png href=https://plasticlabs.ai/icon.png><link href=https://plasticlabs.ai/styles.a66cd1386fb6cb2486b4ca2ecf9e9bca.min.css rel=stylesheet><link href=https://plasticlabs.ai/styles/_light_syntax.86a48a52faebeaaf42158b72922b1c90.min.css rel=stylesheet id=theme-link><script src=https://plasticlabs.ai/js/darkmode.9ad310f41d313c769c255115986b0b04.min.js></script>
<script src=https://plasticlabs.ai/js/util.00639692264b21bc3ee219733d38a8be.min.js></script>
<link rel=preload href=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.css as=style onload='this.onload=null,this.rel="stylesheet"' integrity=sha384-R4558gYOUz8mP9YWpZJjofhk+zx0AS11p36HnD2ZKj/6JR5z27gSSULCNHIRReVs crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/katex.min.js integrity=sha384-z1fJDqw8ZApjGO3/unPWUPsIymfsJmyrDVWC8Tv/a1HeOtGmkwNd/7xUS0Xcnvsx crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.1/dist/contrib/auto-render.min.js integrity=sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.16.2/dist/contrib/copy-tex.min.js integrity=sha384-ww/583aHhxWkz5DEVn6OKtNiIaLi2iBRNZXfJRiY1Ai7tnJ9UXpEsyvOITVpTl4A crossorigin=anonymous></script>
<script src=https://cdn.jsdelivr.net/npm/@floating-ui/core@1.2.1></script>
<script src=https://cdn.jsdelivr.net/npm/@floating-ui/dom@1.2.1></script>
<script defer src=https://plasticlabs.ai/js/popover.aa9bc99c7c38d3ae9538f218f1416adb.min.js></script>
<script defer src=https://plasticlabs.ai/js/code-title.ce4a43f09239a9efb48fee342e8ef2df.min.js></script>
<script defer src=https://plasticlabs.ai/js/clipboard.2913da76d3cb21c5deaa4bae7da38c9f.min.js></script>
<script defer src=https://plasticlabs.ai/js/callouts.7723cac461d613d118ee8bb8216b9838.min.js></script>
<script>const SEARCH_ENABLED=!1,LATEX_ENABLED=!0,PRODUCTION=!0,BASE_URL="https://plasticlabs.ai",fetchData=Promise.all([fetch("https://plasticlabs.ai/indices/linkIndex.7b4395f7124e9dcae137c33d41eeda4f.min.json").then(e=>e.json()).then(e=>({index:e.index,links:e.links})),fetch("https://plasticlabs.ai/indices/contentIndex.23e1d03204d4e8b685385c01cc59a191.min.json").then(e=>e.json())]).then(([{index:e,links:t},n])=>({index:e,links:t,content:n})),render=()=>{const e=new URL(BASE_URL),t=e.pathname,n=window.location.pathname,s=t==n;addCopyButtons(),addTitleToCodeBlocks(),addCollapsibleCallouts(),initPopover("https://plasticlabs.ai",!0);const o=document.getElementById("footer");if(o){const e=document.getElementById("graph-container");if(!e)return requestAnimationFrame(render);e.textContent="";const t=s&&!1;drawGraph("https://plasticlabs.ai",t,[{"/moc":"#4388cc"}],t?{centerForce:1,depth:-1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.5,linkDistance:1,opacityScale:3,repelForce:1,scale:1.4}:{centerForce:1,depth:1,enableDrag:!0,enableLegend:!1,enableZoom:!0,fontSize:.6,linkDistance:1,opacityScale:3,repelForce:2,scale:1.2})}var i=document.getElementsByClassName("mermaid");i.length>0&&import("https://unpkg.com/mermaid@9/dist/mermaid.esm.min.mjs").then(e=>{e.default.init()});function a(n){const e=n.target,t=e.className.split(" "),s=t.includes("broken"),o=t.includes("internal-link");plausible("Link Click",{props:{href:e.href,broken:s,internal:o,graph:!1}})}const r=document.querySelectorAll("a");for(link of r)link.className.includes("root-title")&&link.addEventListener("click",a,{once:!0})},init=(e=document)=>{addCopyButtons(),addTitleToCodeBlocks(),renderMathInElement(e.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1}],macros:{'’':"'"},throwOnError:!1})}</script><script type=module>
    import { attachSPARouting } from "https:\/\/plasticlabs.ai\/js\/router.d6fe6bd821db9ea97f9aeefae814d8e7.min.js"
    attachSPARouting(init, render)
  </script><script defer data-domain=plasticlabs.ai src=https://plausible.io/js/script.js></script>
<script>window.plausible=window.plausible||function(){(window.plausible.q=window.plausible.q||[]).push(arguments)}</script></head><body><div id=search-container><div id=search-space><input autocomplete=off id=search-bar name=search type=text aria-label=Search placeholder="Search for something..."><div id=results-container></div></div></div><script src=https://cdn.jsdelivr.net/npm/flexsearch@0.7.21/dist/flexsearch.bundle.js integrity="sha256-i3A0NZGkhsKjVMzFxv3ksk0DZh3aXqu0l49Bbh0MdjE=" crossorigin=anonymous defer></script>
<script defer src=https://plasticlabs.ai/js/full-text-search.e6e2e0c213187ca0c703d6e2c7a77fcd.min.js></script><div class=singlePage><header><h1 id=page-title><a class=root-title href=https://plasticlabs.ai>Plastic Labs 🥽</a></h1><div class=spacer></div><div id=search-icon><p>Search</p><svg tabindex="0" aria-labelledby="title desc" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 19.9 19.7"><title id="title">Search Icon</title><desc id="desc">Icon to open search</desc><g class="search-path" fill="none"><path stroke-linecap="square" d="M18.5 18.3l-5.4-5.4"/><circle cx="8" cy="8" r="7"/></g></svg></div><div class=darkmode><input class=toggle id=darkmode-toggle type=checkbox tabindex=-1>
<label id=toggle-label-light for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="dayIcon" viewBox="0 0 35 35" style="enable-background:new 0 0 35 35"><title>Light Mode</title><path d="M6 17.5C6 16.672 5.328 16 4.5 16h-3C.672 16 0 16.672.0 17.5S.672 19 1.5 19h3C5.328 19 6 18.328 6 17.5zM7.5 26c-.414.0-.789.168-1.061.439l-2 2C4.168 28.711 4 29.086 4 29.5 4 30.328 4.671 31 5.5 31c.414.0.789-.168 1.06-.44l2-2C8.832 28.289 9 27.914 9 27.5 9 26.672 8.329 26 7.5 26zm10-20C18.329 6 19 5.328 19 4.5v-3C19 .672 18.329.0 17.5.0S16 .672 16 1.5v3C16 5.328 16.671 6 17.5 6zm10 3c.414.0.789-.168 1.06-.439l2-2C30.832 6.289 31 5.914 31 5.5 31 4.672 30.329 4 29.5 4c-.414.0-.789.168-1.061.44l-2 2C26.168 6.711 26 7.086 26 7.5 26 8.328 26.671 9 27.5 9zM6.439 8.561C6.711 8.832 7.086 9 7.5 9 8.328 9 9 8.328 9 7.5c0-.414-.168-.789-.439-1.061l-2-2C6.289 4.168 5.914 4 5.5 4 4.672 4 4 4.672 4 5.5c0 .414.168.789.439 1.06l2 2.001zM33.5 16h-3c-.828.0-1.5.672-1.5 1.5s.672 1.5 1.5 1.5h3c.828.0 1.5-.672 1.5-1.5S34.328 16 33.5 16zM28.561 26.439C28.289 26.168 27.914 26 27.5 26c-.828.0-1.5.672-1.5 1.5.0.414.168.789.439 1.06l2 2C28.711 30.832 29.086 31 29.5 31c.828.0 1.5-.672 1.5-1.5.0-.414-.168-.789-.439-1.061l-2-2zM17.5 29c-.829.0-1.5.672-1.5 1.5v3c0 .828.671 1.5 1.5 1.5s1.5-.672 1.5-1.5v-3C19 29.672 18.329 29 17.5 29zm0-22C11.71 7 7 11.71 7 17.5S11.71 28 17.5 28 28 23.29 28 17.5 23.29 7 17.5 7zm0 18c-4.136.0-7.5-3.364-7.5-7.5s3.364-7.5 7.5-7.5 7.5 3.364 7.5 7.5S21.636 25 17.5 25z"/></svg></label><label id=toggle-label-dark for=darkmode-toggle tabindex=-1><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" id="nightIcon" viewBox="0 0 100 100" style="enable-background='new 0 0 100 100'"><title>Dark Mode</title><path d="M96.76 66.458c-.853-.852-2.15-1.064-3.23-.534-6.063 2.991-12.858 4.571-19.655 4.571C62.022 70.495 50.88 65.88 42.5 57.5 29.043 44.043 25.658 23.536 34.076 6.47c.532-1.08.318-2.379-.534-3.23-.851-.852-2.15-1.064-3.23-.534-4.918 2.427-9.375 5.619-13.246 9.491-9.447 9.447-14.65 22.008-14.65 35.369.0 13.36 5.203 25.921 14.65 35.368s22.008 14.65 35.368 14.65c13.361.0 25.921-5.203 35.369-14.65 3.872-3.871 7.064-8.328 9.491-13.246C97.826 68.608 97.611 67.309 96.76 66.458z"/></svg></label></div></header><article><h1>Theory-of-Mind Is All You Need</h1><p class=meta>Last updated
Nov 15, 2023</p><ul class=tags></ul><a href=#tldr><h2 id=tldr><span class=hanchor arialabel=Anchor># </span>TL;DR</h2></a><p>Today we’re releasing a major upgrade to
<a href=https://discord.gg/bloombot.ai rel=noopener>Bloom</a> (& the open-source codebase,
<a href=https://github.com/plastic-labs/tutor-gpt rel=noopener>Tutor-GPT</a>).</p><p>We gave our tutor even more autonomy to reason about the psychology of the user, and—using GPT-4 to dynamically <em>rewrite its own</em> system prompts—we’re able to dramatically expand the scope of what Bloom can do <em>and</em> massively reduce our prompting architecture.</p><p>We leaned into theory of mind experiments and Bloom is now more than just a literacy tutor, it’s an expansive learning companion.</p><a href=#satisfying-objective-discovery><h2 id=satisfying-objective-discovery><span class=hanchor arialabel=Anchor># </span>Satisfying Objective Discovery</h2></a><p>Bloom is already excellent at helping you draft and understand language. But we want it do whatever you need.</p><p>To expand functionality though, we faced a difficult technical problem: figuring out what the learner wants to do.</p><p>Sounds simple (just ask), yet any teacher will tell you, students are often the last to understand what they ought to be doing. Are you learning for its own sake, or working on an assignment? What are the expectations and parameters? What preferences do you have about how this gets done?</p><p>Explaining all this to a tutor (synthetic or biological) upfront, is laborious and tiresome. We could just add some buttons, but that’s a deterministic cop-out.</p><p><img src="/assets/ToM meme.jpeg" width=auto></p><p>What a expert educators will do is gather more information throughout the completion of the task, resolving on a more precise objective along the way; keeping the flow natural, and leaving the door open to compelling tangents and pivots.</p><p>The key here is they don’t have all the information—they <em>don’t know</em> what the objective is precisely—but being good at tutoring means turning that into an advantage, figuring it out along the way is <em>optimal</em>. The effective human tutor dynamically iterates on a set of internal models about student psychology and session objectives. So how do we recreate this in Bloom?</p><p>Well we know that (1) foundation models are
<a href=https://arxiv.org/abs/2304.11490 rel=noopener>shockingly good</a> at
<a href=https://en.wikipedia.org/wiki/Theory_of_mind rel=noopener>theory of mind</a>, (2) Bloom already excels at
<a href="https://twitter.com/courtlandleer/status/1664673210007449605?s=20" rel=noopener>pedagogical reasoning</a>, and (3)
<a href="https://twitter.com/yoheinakajima/status/1642881722495954945?s=20" rel=noopener>autonomous agents</a> are
<a href="https://twitter.com/Auto_GPT/status/1649370049688354816?s=20" rel=noopener>having early success</a>, so what if we stopped trying to deterministically prescribe an indeterminant intelligence?</p><p>What if we treated Bloom with some intellectual respect?</p><a href=#autonomous-prompting><h2 id=autonomous-prompting><span class=hanchor arialabel=Anchor># </span>Autonomous Prompting</h2></a><p>The solution here is scary simple. The results are scary good.</p><p><a href=https://plasticlabs.ai/blog/Open-Sourcing-Tutor-GPT/ rel=noopener>Here’s a description</a> of the previous version’s architecture:</p><blockquote><p>Bloom was built and prompted to elicit [pedagogical reasoning]…After each input it revises a user’s real-time academic needs, considers all the information at its disposal, and suggests to itself a framework for constructing the ideal response.</p><p>It consists of two “chain” objects from 
<a href=https://python.langchain.com/en/latest/index.html rel=noopener>LangChain</a> —a <em>thought</em> and <em>response</em> chain. The <em>thought</em> chain exists to prompt the model to generate a pedagogical thought about the student’s input—e.g. a student’s mental state, learning goals, preferences for the conversation, quality of reasoning, knowledge of the text, etc. The <em>response</em> chain takes that <em>thought</em> and generates a response.</p><p>Each chain has a <code>ConversationSummaryBufferMemory</code> object summarizing the respective “conversations.” The <em>thought</em> chain summarizes the thoughts into a rank-ordered academic needs list that gains specificity and gets reprioritized with each student input. The <em>response</em> chain summarizes the dialogue in an attempt to avoid circular conversations and record learning progress.</p></blockquote><p>Instead, we’ve now repurposed the <em><strong>thought</strong></em> chain to do two things:</p><ul><li>Predict the user’s unobserved mental state</li><li>List the information needed to enhance that prediction</li></ul><p><img src="/assets/ToM Flow.png" width=auto></p><p>Then we inject that generation into the body of the response chain’s system prompt. We do this with every user input. Instead of just reasoning about the learner’s intellectual/academic needs, Bloom now proactively rewrites itself to be as in-tune as possible to the learner at every step of the journey.</p><a href=#emergent-effects><h2 id=emergent-effects><span class=hanchor arialabel=Anchor># </span>Emergent Effects</h2></a><p>We’re seeing substantial positive behavior changes as a result of giving Bloom this kind of autonomy.</p><p><img src="/assets/ToM Discord 1.png" width=auto></p><p>Bloom is more pleasant to converse with. It’s still Socratic and will still push you to learn, but it’s not nearly as restrictive. Mainly, we posit this is a result of the tutor cohering to the user. Bloom becomes more like its interlocutor, it’s in many ways a mirror. This has a positive psychological effect—think of your favorite teacher from high school or college.</p><p><img src="/assets/ToM Discord 2.png" width=auto></p><p>And Bloom is game. It’ll go down a rabbit hole with you, help you strategize around an assignment, or just chat. Bloom displays impressive discernment between acting on theory of mind recommendations to gather more information from you and asking topically-related questions to keep up the momentum of the conversation. It’s no longer obsessed with conforming to the popular stereotype of a tutor or teacher.</p><p><img src="/assets/ToM Discord 3.png" width=auto></p><p>While reducing the prompt material, we took to opportunity to remove basically all references to “tutor,” “student,” etc. We found that since Bloom is no longer contaminated by pointing at
<a href=https://www.lesswrong.com/posts/D7PumeYTDPfBTp3i7/the-waluigi-effect-mega-post rel=noopener>certain averaged narratives in its pre-training</a>—e.g. the (bankrupt) contemporary conception of what a tutor is ‘supposed’ to be—it is, ironically, a better one.</p><p>Instead of simulating a tutor, it simulates <em>you</em>.</p><a href=#coming-soon><h2 id=coming-soon><span class=hanchor arialabel=Anchor># </span>Coming Soon&mldr;</h2></a><p>All this begs the question: what could Bloom do with even better theory of mind? And how can we facilitate that?</p><p>What could other AI applications do with a framework like this?</p><p>Stay tuned.</p></article><hr><div class=page-end id=footer><div class=backlinks-container><h3>Backlinks</h3><ul class=backlinks><li><a href=/ data-ctx="blog/Theory-of-Mind Is All You Need" data-src=/ class=internal-link>Plastic Labs 🥽</a></li></ul></div><div><script src=https://cdn.jsdelivr.net/npm/d3@6.7.0/dist/d3.min.js integrity="sha256-+7jaYCp29O1JusNWHaYtgUn6EhuP0VaFuswhNV06MyI=" crossorigin=anonymous></script><h3>Interactive Graph</h3><div id=graph-container></div><style>:root{--g-node:var(--secondary);--g-node-active:var(--primary);--g-node-inactive:var(--visited);--g-link:var(--outlinegray);--g-link-active:#5a7282}</style><script src=https://plasticlabs.ai/js/graph.6579af7b10c818dbd2ca038702db0224.js></script></div></div><div id=contact_buttons><footer><p>Made by Plastic Labs using <a href=https://github.com/jackyzha0/quartz>Quartz</a>, © 2023</p><ul><li><a href=https://plasticlabs.ai>Home</a></li><li><a href=https://twitter.com/plastic_labs>Twitter</a></li><li><a href=https://github.com/plastic-labs>GitHub</a></li></ul></footer></div></div></body></html>